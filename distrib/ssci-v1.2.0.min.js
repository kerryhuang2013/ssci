/*! ssci v1.2.0 
 *  JavaScript smoothing, seasonal and regression functions 
 *  2016-02-22 
 *  License: GPL-3.0 
 *  Copyright (C) 2016 Simon West
 */

var ssci = (function(){ 
  'use strict';


function k_G(a,b,c){return 1/Math.sqrt(2*Math.PI)*Math.exp(-(Math.pow(a-b,2)/(2*Math.pow(c,2))))}function k_E(a,b,c){return Math.abs((a-b)/c)>1?0:.75*(1-Math.pow((a-b)/c,2))}function k_L(a,b,c){return 1/(Math.exp((a-b)/c)+Math.exp(-(a-b)/c))}function k_U(a,b,c){return Math.abs((a-b)/c)>1?0:.5}function k_T(a,b,c){return Math.abs((a-b)/c)>1?0:1-Math.abs((a-b)/c)}function k_Q(a,b,c){return Math.abs((a-b)/c)>1?0:.9375*Math.pow(1-Math.pow((a-b)/c,2),2)}function k_TW(a,b,c){return Math.abs((a-b)/c)>1?0:35/32*Math.pow(1-Math.pow((a-b)/c,2),3)}function k_Co(a,b,c){return Math.abs((a-b)/c)>1?0:Math.PI/4*Math.cos(Math.PI/2*((a-b)/c))}function k_TC(a,b,c){return Math.abs((a-b)/c)>1?0:70/81*Math.pow(1-Math.pow(Math.abs((a-b)/c),3),3)}function k_S(a,b,c){var d=Math.abs((b-a)/c);return.5*Math.exp(-d/Math.SQRT2)*Math.sin(d/Math.SQRT2+Math.PI/4)}function splineInterpolation(a){var b,c=[],d=[],e=[],f=[],g=[],h=[],i=[],j=[],k=[],l=[];for(b=0;b<a.length-1;b++)c[b]=a[b+1][0]-a[b][0];for(b=1;b<a.length-1;b++)d[b]=3/c[b]*(a[b+1][1]-a[b][1])-3/c[b-1]*(a[b][1]-a[b-1][1]);for(e[0]=1,f[0]=0,g[0]=0,b=1;b<a.length-1;b++)e[b]=2*(a[b+1][0]-a[b-1][0])-c[b-1]*f[b-1],f[b]=c[b]/e[b],g[b]=(d[b]-c[b-1]*g[b-1])/e[b];e[a.length-1]=1,g[a.length-1]=0,h[a.length-1]=0;for(var m=a.length-2;m>=0;m--)h[m]=g[m]-f[m]*h[m+1],j[m]=(a[m+1][1]-a[m][1])/c[m]-c[m]*(h[m+1]+2*h[m])/3,i[m]=(h[m+1]-h[m])/(3*c[m]),k[m]=a[m][1],l[m]=[k[m],j[m],h[m],i[m]];return l}function splineToBezier(a,b,c){var d=[1/3,2/3],e=[(b[0]-a[0])*d[0]+a[0],(b[0]-a[0])*d[1]+a[0]],f=[c[0]+c[1]*(e[0]-a[0])+c[2]*Math.pow(e[0]-a[0],2)+c[3]*Math.pow(e[0]-a[0],3),c[0]+c[1]*(e[1]-a[0])+c[2]*Math.pow(e[1]-a[0],2)+c[3]*Math.pow(e[1]-a[0],3)],g=[(f[0]-Math.pow(1-d[0],3)*a[1]-Math.pow(d[0],3)*b[1])/(3*(1-d[0])*d[0]),(f[1]-Math.pow(1-d[1],3)*a[1]-Math.pow(d[1],3)*b[1])/(3*(1-d[1])*d[1])],h=[];return h[0]=(g[1]-d[1]*g[0]/d[0])*(1/(1-d[1]/d[0])),h[1]=(g[0]-(1-d[0])*h[0])/d[0],[[e[0],h[0]],[e[1],h[1]]]}var ssci=ssci||{};ssci.smooth={},ssci.season={},ssci.reg={},ssci.fore={},ssci.ts={},ssci.mr={},ssci.fore.expon=function(){function a(){var a,j=[];for(j=b.map(function(a){return[h(a),i(a)]}),c=j.length,a=1;c+1>a;a++)2>a?d.push([j[a][0],j[a-1][1]]):a===c?d.push([+j[a-1][0]+(+j[a-1][0]-j[a-2][0]),j[a-1][1]*g+d[a-2][1]*(1-g)]):d.push([j[a][0],j[a-1][1]*g+d[a-2][1]*(1-g)]);for(a=1;c>a;a++)e.push(j[a][1]-d[a-1][1]),f+=Math.pow(j[a][1]-d[a-1][1],2)}var b=[],c=0,d=[],e=[],f=0,g=.3,h=function(a){return a[0]},i=function(a){return a[1]};return a.x=function(b){return arguments.length?(h=b,a):h},a.y=function(b){return arguments.length?(i=b,a):i},a.data=function(c){return b=c,a},a.factor=function(b){return arguments.length?"number"!=typeof b?(console.log("Factor appears to not be a number - changed to 0.3"),g=.3,a):b>1||0>b?(console.log("Factor >1 or <0 - changed to 0.3"),g=.3,a):(g=b,a):g},a.output=function(){return d},a.residuals=function(){return e},a.sumSquares=function(){return f},a},ssci.fore.holtWinter=function(){function a(){var a;for(f=e.map(function(a){return[l(a),m(a)]}),n=f.length,0===q.length&&b(),0===r.length&&c(),0===s.length&&d(),a=+j;n>a;a++)q.push(g*f[a][1]/s[a-j]+(1-g)*(q[a-1]+r[a-1])),r.push(h*(q[a]-q[a-1])+(1-h)*r[a-1]),s.push(i*f[a][1]/q[a]+(1-i)*s[a-j]),o.push([f[a][0],(q[a-1]+r[a-1])*s[a-j]]);for(a=+j;n>a;a++)p.push(f[a][1]-o[a-j][1]),k+=Math.pow(f[a][1]-o[a-j][1],2)}function b(){var a,b=0;for(a=0;j>a;a++)b+=f[a][1];for(a=0;j>a;a++)q.push(b/j)}function c(){var a,b=0;for(a=0;j>a;a++)b+=(f[a+j][1]-f[a][1])/j;for(a=0;j>a;a++)r.push(b*(1/j))}function d(){var a,b,c=Math.floor(n/j),d=[];for(a=0;c>a;a++){var e=0;for(b=0;j>b;b++)e+=f[b+a*j][1];e/=j,d.push(e)}for(b=0;j>b;b++){var g=0;for(a=0;c>a;a++)g+=f[b+a*j][1]/d[a];s.push(g/c)}}var e=[],f=[],g=.3,h=.3,i=.3,j=12,k=0,l=function(a){return a[0]},m=function(a){return a[1]},n=0,o=[],p=[],q=[],r=[],s=[];return a.initialLevel=function(b){if(!arguments.length)return q[0];q=[];for(var c=0;j>c;c++)q.push(b);return a},a.initialTrend=function(b){if(!arguments.length)return r[0];r=[];for(var c=0;j>c;c++)r.push(b);return a},a.initialSeason=function(b){return arguments.length&&Array.isArray(b)?b.length!==j?NaN:(s=[],s=b,a):s.slice(0,j)},a.period=function(b){return arguments.length?("number"!=typeof j&&(console.log("Period appears to not be a number - changed to 12"),j=12),j=b,a):j},a.data=function(b){if(e=b,n=e.length,j>=n/2)throw new Error("Not enough data to estimate forecasts - need 2*period of data");return a},a.x=function(b){return arguments.length?(l=b,a):l},a.y=function(b){return arguments.length?(m=b,a):m},a.output=function(){return o},a.outputY=function(){return o.map(function(a){return a[1]})},a.residuals=function(){return p},a.sumSquares=function(){return k},a.level=function(b){return 0===arguments.length?g:("number"!=typeof g&&(console.log("Factor appears to not be a number - changed to 0.3"),g=.3),g>1||0>g?(console.log("Factor >1 or <0 - changed to 0.3"),g=.3):g=b,a)},a.trend=function(b){return 0===arguments.length?h:("number"!=typeof h&&(console.log("Trend factor appears to not be a number - changed to 0.3"),h=.3),h>1||0>h?(console.log("Trend >1 or <0 - changed to 0.3"),h=.3):h=b,a)},a.season=function(b){return 0===arguments.length?i:("number"!=typeof i&&(console.log("Seasonal factor appears to not be a number - changed to 0.3"),i=.3),i>1||0>i?(console.log("Season >1 or <0 - changed to 0.3"),i=.3):i=b,a)},a.forecast=function(a){for(var b=[],c=f[1][0]-f[0][0],d=0;a>d;d++){var e=d%j+1;b.push([+f[n-1][0]+c*(d+1),(q[n-1]+(d+1)*r[n-1])*s[n-1-j+e]])}return b},a},ssci.fore.holt=function(){function a(){var a;for(c=b.map(function(a){return[j(a),k(a)]}),d=c.length,e.push(c[0]),0===l.length&&l.push(c[0][1]),0===m.length&&m.push(1/3*(c[1][1]-c[0][1])+(c[2][1]-c[1][1])+(c[3][1]-c[2][1])),a=1;d>a;a++)l.push(h*c[a][1]+(1-h)*(l[a-1]+m[a-1])),m.push(i*(l[a]-l[a-1])+(1-i)*m[a-1]),e.push([c[a][0],l[a-1]+m[a-1]]);for(g=0,a=1;d>a;a++)f.push(c[a][1]-e[a][1]),g+=Math.pow(c[a][1]-e[a][1],2)}var b=[],c=[],d=0,e=[],f=[],g=0,h=.3,i=.3,j=function(a){return a[0]},k=function(a){return a[1]},l=[],m=[];return a.initialLevel=function(b){return arguments.length?(l=[],l.push(b),a):l[0]},a.initialTrend=function(b){return arguments.length?(m=[],m.push(b),a):m[0]},a.x=function(b){return arguments.length?(j=b,a):j},a.y=function(b){return arguments.length?(k=b,a):k},a.data=function(c){return b=c,a},a.factor=function(b){return arguments.length?"number"!=typeof b?(console.log("Factor appears to not be a number - changed to 0.3"),h=.3,a):b>1||0>b?(console.log("Factor >1 or <0 - changed to 0.3"),h=.3,a):(h=b,a):h},a.output=function(){return e},a.residuals=function(){return f},a.sumSquares=function(){return g},a.trend=function(b){return arguments.length?"number"!=typeof b?(console.log("Trend factor appears to not be a number - changed to 0.3"),i=.3,a):b>1||0>b?(console.log("Trend >1 or <0 - changed to 0.3"),i=.3,a):(i=b,a):i},a.forecast=function(a){if("number"!=typeof a)throw new Error("Input is not a number");var b=l[l.length-1]+a*m[m.length-1];return b},a},ssci.mr.cnegbin=function(a,b,c){if(3!==arguments.length)throw new Error("Incorrect number of arguments passed");if("number"!=typeof a)throw new Error("r is not a number");if("number"!=typeof b)throw new Error("m is not a number");if("number"!=typeof c)throw new Error("b is not a number");if(c>1||0>c)throw new Error("b must be between 0 and 1");a=Math.round(a);var d=0;return d=1>a?ssci.mr.negbin(0,b,c):ssci.mr.negbin(a,b,c)+ssci.mr.cnegbin(a-1,b,c)},ssci.mr.nbd_a=function(a,b){if(2!==arguments.length)throw new Error("Incorrect number of arguments passed");if("number"!=typeof b)throw new Error("m is not a number");if("number"!=typeof a)throw new Error("b is not a number");if(a>1||0>a)throw new Error("b must be between 0 and 1");var c=b/a,d=-(a*c/Math.log(1-a)),e=d*Math.log(d)+d-1,f=e-(d*Math.log(1+e)-e)/(d/(e+1)-1),g=100,h=1e-15,i=0;do i++,e=f,f=e-(d*Math.log(1+e)-e)/(d/(e+1)-1);while(g>i&&Math.abs(e-f)>h);return e},ssci.mr.negbin=function(a,b,c){if(3!==arguments.length)throw new Error("Incorrect number of arguments passed");if("number"!=typeof a)throw new Error("r is not a number");if("number"!=typeof b)throw new Error("m is not a number");if("number"!=typeof c)throw new Error("b is not a number");if(c>1||0>c)throw new Error("b must be between 0 and 1");a=Math.round(a);var d=ssci.mr.nbd_a(c,b),e=b/d;return b>=-Math.log(1-c)?ssci.gamma(e+a)/(ssci.gamma(a+1)*ssci.gamma(e))*Math.pow(d+1,-e)*Math.pow(d/(d+1),a):NaN},ssci.reg.determinant=function(a){var b,c,d,e,f,g=[];e=a.length,b=e-2,f=0;for(var h=0;b>=h;h++){for(var i=[],j=0;b>=j;j++)i.push(0);g.push(i)}for(h=0;e>h;h++){c=0,d=0;for(var k=0;e>k;k++){for(var l=0;e>l;l++)l!==h&&k!==b&&(g[c][d]=a[l][k]),l!==h&&c++;c=0,k!==b&&d++}f+=b>0?Math.pow(-1,h+b)*a[h][b]*ssci.reg.determinant(g):Math.pow(-1,h+b)*a[h][b]*g[0][0]}return f},ssci.reg.determinantBig=function(a){var b,c,d,e,f,g=[];e=a.length,b=e-2,f=new Big(0);for(var h=0;b>=h;h++){for(var i=[],j=0;b>=j;j++)i.push(new Big(0));g.push(i)}for(h=0;e>h;h++){c=0,d=0;for(var k=0;e>k;k++){for(var l=0;e>l;l++)l!==h&&k!==b&&(g[c][d]=new Big(a[l][k].valueOf())),l!==h&&c++;c=0,k!==b&&d++}f=b>0?f.plus(a[h][b].times(Math.pow(-1,h+b)).times(ssci.reg.determinantBig(g))):f.plus(a[h][b].times(Math.pow(-1,h+b)).times(g[0][0]))}return f},ssci.reg.poly=function(){function a(){var a=[];for(a=m.map(function(a){return[k(a),l(a)]}),n>a.length-1&&(n=a.length-1,console.log("Order changed to "+(a.length-1))),c=0;n+1>c;c++){var o=[],p=[];for(e=0;n+1>e;e++)o.push(0),p.push(0);g.push(o),h.push(p),i.push(0)}for(c=0;n+1>c;c++)for(d=0;n+1>d;d++)for(e=0;e<a.length;e++)g[c][d]+=Math.pow(a[e][0],c+d);for(d=0;n+1>d;d++)for(e=0;e<a.length;e++)i[d]+=Math.pow(a[e][0],d)*a[e][1];for(b=ssci.reg.determinant(g),c=0;n+1>c;c++){for(d=0;n+1>d;d++)for(e=0;n+1>e;e++)e===c?h[d][e]=i[d]:h[d][e]=g[d][e];j.push(ssci.reg.determinant(h)/b)}for(e=0;e<a.length;e++){var q=0;for(d=0;n+1>d;d++)q+=Math.pow(a[e][0],d)*j[d];f.push([a[e][0],q])}}var b,c,d,e,f=[],g=[],h=[],i=[],j=[],k=function(a){return a[0]},l=function(a){return a[1]},m=[],n=2;return a.order=function(b){return arguments.length?("number"!=typeof b&&(n=2),0>=b&&(n=2),n=b,a):n},a.output=function(){return f},a.x=function(b){return arguments.length?(k=b,a):k},a.y=function(b){return arguments.length?(l=b,a):l},a.data=function(b){return m=b,a},a},ssci.reg.polyBig=function(){function a(){var a=[];for(a=p.map(function(a){return[n(a),o(a)]}),q>a.length-1&&(q=a.length-1,console.log("Order changed to "+(a.length-1))),c=0;c<a.length;c++){var r=[];r.push(new Big(+a[c][0])),r.push(new Big(+a[c][1])),m.push(r)}for(c=0;q+1>c;c++){var s=[],t=[];for(e=0;q+1>e;e++)s.push(new Big(0)),t.push(new Big(0));h.push(s),i.push(t),j.push(new Big(0))}for(c=0;q+1>c;c++)for(d=0;q+1>d;d++)for(e=0;e<a.length;e++)h[c][d]=h[c][d].plus(m[e][0].pow(c+d));for(d=0;q+1>d;d++)for(e=0;e<a.length;e++)j[d]=j[d].plus(m[e][0].pow(d).times(m[e][1]));if(b=ssci.reg.determinantBig(h),"0"===b.valueOf())throw new Error("Determinant is zero. Fitted line is not calculable.");for(c=0;q+1>c;c++){for(d=0;q+1>d;d++)for(e=0;q+1>e;e++)e===c?i[d][e]=j[d]:i[d][e]=h[d][e];k.push(ssci.reg.determinantBig(i).div(b)),l.push(parseFloat(k[c].valueOf()))}for(e=0;e<a.length;e++){var u=new Big(0);for(d=0;q+1>d;d++)u=u.plus(m[e][0].pow(d).times(k[d]));f.push([a[e][0],u.valueOf()]),g.push(a[e][1]-parseFloat(u.toString()))}}var b,c,d,e,f=[],g=[],h=[],i=[],j=[],k=[],l=[],m=[],n=function(a){return a[0]},o=function(a){return a[1]},p=[],q=2;return a.order=function(b){return arguments.length?("number"!=typeof b&&(q=2),0>=b&&(q=2),q=b,a):q},a.output=function(){return f},a.x=function(b){return arguments.length?(n=b,a):n},a.y=function(b){return arguments.length?(o=b,a):o},a.data=function(b){return p=b,a},a.residuals=function(){return g},a.constants=function(){return l},a.forecast=function(a){if("number"!=typeof a)throw new Error("Input is not a number");for(var b=new Big(0),c=0;q+1>c;c++)b=b.plus(m[m.length-1][0].plus(a).pow(c).times(k[c]));return b},a},ssci.season.average=function(){function a(){var a=[];if(a=g.map(function(a){return[e(a),f(a)]}),c=a.length,"object"!=typeof h||!Array.isArray(h))throw console.log(h),new Error("Invalid label parameter");if(h.length!==a.length)throw console.log(h),new Error("Labels array is not the same length as the data array");var i={},j={},k={},l=0,m=0;for(b=0;b<h.length;b++)h[b]in i?i[h[b]]=i[h[b]]+a[b][1]:i[h[b]]=a[b][1],h[b]in j?j[h[b]]=j[h[b]]+1:j[h[b]]=1,h[b]in k||(k[h[b]]=0),l+=a[b][1],m++;for(var n=Object.keys(k),o=0;o<n.length;o++)k[n[o]]=i[n[o]]*m/(j[n[o]]*l);for(b=0;c>b;b++)d.push([a[b][0],a[b][1]/k[h[b]]])}var b,c=0,d=[],e=function(a){return a[0]},f=function(a){return a[1]},g=[],h=[];return a.labels=function(b){return h=b,a},a.output=function(){return d},a.x=function(b){return arguments.length?(e=b,a):e},a.y=function(b){return arguments.length?(f=b,a):f},a.data=function(b){return g=b,a},a},ssci.season.difference=function(){function a(){var a=[];if(a=h.map(function(a){return[f(a),g(a)]}),c=a.length,i>c)throw new Error("Not enough data for this frequency");for(b=i;c>b;b++){e[b]=0;for(var j=0;i>j;j++)e[b]+=a[b-j][1];e[b]/=i}for(b=i;c>b;b++)d.push([a[b][0],a[b][1]-a[b-i][1]+e[b]])}var b,c=0,d=[],e=[],f=function(a){return a[0]},g=function(a){return a[1]},h=[],i=12;return a.output=function(){return d},a.x=function(b){return arguments.length?(f=b,a):f},a.y=function(b){return arguments.length?(g=b,a):g},a.data=function(b){return h=b,a},a.frequency=function(b){return arguments.length?("number"!=typeof b&&(console.log("frequency appears to not be a number - changed to 12"),i=12),i=b,a):i},a},ssci.season.movingAverage=function(){function a(){var a=[];if(a=j.map(function(a){return[h(a),i(a)]}),c=a.length,k>c)throw new Error("Not enough data for this frequency");var m=Math.floor(k/2);for(b=0;k>b;b++)g[b]=1;for(b=k-1;c>b;b++){f=0,e=0;for(var n=b-(k-1);b>=n;n++)e+=a[n][1]*g[f],f++;l?d.push([a[b][0],e/k]):d.push([a[b-m+1][0],e/k])}}var b,c=0,d=[],e=0,f=1,g=[],h=function(a){return a[0]},i=function(a){return a[1]},j=[],k=12,l=!0;return a.end=function(b){return arguments.length?("boolean"!=typeof b&&(l=!0),l=b,a):l},a.output=function(){return d},a.x=function(b){return arguments.length?(h=b,a):h},a.y=function(b){return arguments.length?(i=b,a):i},a.data=function(b){return j=b,a},a.frequency=function(b){return arguments.length?("number"!=typeof b&&(console.log("frequency appears to not be a number - changed to 12"),k=12),k=b,a):k},a},ssci.smooth.EWMA=function(){function a(){var a=[];a=f.map(function(a){return[d(a),e(a)]}),b=a.length;for(var h=0;b>h;h++)0===h?c.push(a[h]):c.push([a[h][0],a[h][1]*g+c[h-1][1]*(1-g)])}var b=0,c=[],d=function(a){return a[0]},e=function(a){return a[1]},f=[],g=.3;return a.output=function(){return c},a.x=function(b){return arguments.length?(d=b,a):d},a.y=function(b){return arguments.length?(e=b,a):e},a.data=function(b){return f=b,a},a.factor=function(b){return arguments.length?"number"!=typeof b?(console.log("Factor appears to not be a number - changed to 0.3"),g=.3,a):b>1||0>b?(console.log("Factor >1 or <0 - changed to 0.3"),g=.3,a):(g=b,a):g},a},ssci.smooth.filter=function(){function a(){var a=[];if(a=j.map(function(a){return[h(a),i(a)]}),d=a.length,f=Math.floor(k.length/2),!l)for(b=0;f>b;b++){for(g=0,c=0;2*f+1>c;c++)g+=b+c-f>=0?a[b+c-f][1]*k[c]:a[b][1]*k[c];e.push([a[b][0],g])}for(b=f;d-f>b;b++){for(g=0,c=0;2*f+1>c;c++)g+=a[b+c-f][1]*k[c];e.push([a[b][0],g])}if(!l)for(b=d-f;d>b;b++){for(g=0,c=0;2*f+1>c;c++)g+=d>b+c-f?a[b+c-f][1]*k[c]:a[b][1]*k[c];e.push([a[b][0],g])}}var b,c,d=0,e=[],f=0,g=0,h=function(a){return a[0]},i=function(a){return a[1]},j=[],k=[],l=!0;return a.output=function(){return e},a.x=function(b){return arguments.length?(h=b,a):h},a.y=function(b){return arguments.length?(i=b,a):i},a.data=function(b){return j=b,a},a.filter=function(b){if(!arguments.length)return k;if("object"!=typeof b||!Array.isArray(b))throw new Error("Filter must be an array");if(b.length%2===0)throw new Error("Filter must be of an odd size");if(b.length<3)throw new Error("Filter size must be greater than 2");return k=b,a},a.end=function(b){return arguments.length?("boolean"!=typeof l&&(l=!0),l=b,a):l},a.gain=function(a){var d=0,e=0,g=0;for(b=0;b<k.length;b++)e+=k[c]*Math.cos(2*(c-f)*Math.PI/a),g+=k[c]*Math.sin(2*(c-f)*Math.PI/a);return d=Math.sqrt(e*e+g*g)},a.phaseShift=function(){},a},ssci.smooth.kernel=function(){function a(){var a=[];a=f.map(function(a){return[h(a),i(a)]});var j=[];if("number"==typeof g)for(b=0;b<a.length;b++)j.push(g);else{if("object"!=typeof g||!Array.isArray(g))throw console.log(g),new Error("Invalid scale parameter");if(g.length===a.length)j=g.slice();else{var k=0;for(b=0;b<a.length;b++)j.push(g[k]),b<g.length?k++:k=0}}for(b=0;b<a.length;b++){for(var l=0,m=0,n=0;n<a.length;n++){var o=0;o=d[e](a[b][0],a[n][0],j[b]),l+=o*a[n][1],m+=o}c.push([a[b][0],l/m])}}var b,c=[],d={Uniform:k_U,Triangle:k_T,Epanechnikov:k_E,Quartic:k_Q,Triweight:k_TW,Logistic:k_L,Cosine:k_Co,Gaussian:k_G,Tricube:k_TC,Silverman:k_S},e="Gaussian",f=[],g=[],h=function(a){return a[0]},i=function(a){return a[1]};return a.scale=function(b){return arguments.length?(g=b,a):g},a.kernel=function(b){if(!arguments.length)return e;if("function"!=typeof d[b])throw new Error("Invalid kernel");return e=b,a},a.x=function(b){return arguments.length?(h=b,a):h},a.y=function(b){return arguments.length?(i=b,a):i},a.output=function(){return c},a.data=function(b){return f=b,a},a},ssci.smooth.kernel2=function(){function a(){var a=[];a=h.map(function(a){return[j(a),k(a)]});var l=[];if("number"==typeof g)for(b=0;b<a.length;b++)l.push(g);else{if("object"!=typeof g||!Array.isArray(g))throw console.log(g),new Error("Invalid scale parameter");if(g.length===a.length)l=g.slice();else{var m=0;for(b=0;b<a.length;b++)l.push(g[m]),b<g.length?m++:m=0}}for(b=0;b<a.length;b++){var n=0,o=0,p=0,q=e[i](a[b][0],a[b][0],l[b]);for(n+=q*a[b][1],o+=q,c=b-1;c>-1&&(p=e[i](a[b][0],a[c][0],l[b]),!(f>p/q));c--)n+=p*a[c][1],o+=p;for(c=b+1;c<a.length&&(p=e[i](a[b][0],a[c][0],l[b]),!(f>p/q));c++)n+=p*a[c][1],o+=p;d.push([a[b][0],n/o])}}var b,c,d=[],e={Uniform:k_U,Triangle:k_T,Epanechnikov:k_E,Quartic:k_Q,Triweight:k_TW,Logistic:k_L,Cosine:k_Co,Gaussian:k_G,Tricube:k_TC,Silverman:k_S},f=.001,g=[],h=[],i="Gaussian",j=function(a){return a[0]},k=function(a){return a[1]};return a.scale=function(b){return arguments.length?(g=b,a):g},a.kernel=function(b){if(!arguments.length)return i;if("function"!=typeof e[b])throw new Error("Invalid kernel");return i=b,a},a.x=function(b){return arguments.length?(j=b,a):j},a.y=function(b){return arguments.length?(k=b,a):k},a.output=function(){return d},a.diff=function(b){return arguments.length?(f=b,a):f},a.data=function(b){return h=b,a},a},ssci.smooth.quadratic=function(){function a(){var a=[];a=t.map(function(a){return[r(a),s(a)]}),h=a.length;for(var f=0;h>f;f++){for(var u=f-g;f+g>=u;u++){var v;v=u,0>v&&(v=0),v>h-1&&(v=h-1),i++,j+=a[v][0],k+=Math.pow(a[v][0],2),l+=Math.pow(a[v][0],3),m+=Math.pow(a[v][0],4),n+=a[v][1],o+=a[v][0]*a[v][1],p+=Math.pow(a[v][0],2)*a[v][1]}b=i*(k*m-l*l)-j*(j*m-l*k)+k*(j*l-k*k),c=(k*m-l*l)*n-(j*m-l*k)*o+(j*l-k*k)*p,d=-(j*m-k*l)*n+(i*m-k*k)*o-(i*l-j*k)*p,e=(j*l-k*k)*n-(i*l-j*k)*o+(i*k-j*j)*p,q.push([a[f][0],c/b+a[f][0]*(d/b)+a[f][0]*a[f][0]*(e/b)]),i=0,j=0,k=0,l=0,m=0,n=0,o=0,p=0}}var b,c,d,e,f=5,g=2,h=0,i=0,j=0,k=0,l=0,m=0,n=0,o=0,p=0,q=[],r=function(a){return a[0]},s=function(a){return a[1]},t=[];return a.width=function(b){return"number"!=typeof b?(console.log("width appears to not be a number - changed to 5"),a):(b%2===0&&b--,3>b&&(b=5),f=b,g=Math.floor(b/2),a)},a.data=function(b){return t=b,a},a.x=function(b){return arguments.length?(r=b,a):r},a.y=function(b){return arguments.length?(s=b,a):s},a.output=function(){return q},a},ssci.smooth.quadraticBig=function(){function a(){var a=[];a=h.map(function(a){return[f(a),g(a)]}),d=a.length;for(var b=0;d>b;b++){for(var i=[],j=b-c;b+c>=j;j++)0>j?i.push(a[0]):j>d-1?i.push(a[d-1]):i.push(a[j]);var k=ssci.reg.polyBig().data(i).order(2);k();var l=k.constants();e.push([a[b][0],l[0]+a[b][0]*l[1]+a[b][0]*a[b][0]*l[2]])}}var b=5,c=2,d=0,e=[],f=function(a){return a[0]},g=function(a){return a[1]},h=[];return a.width=function(d){return arguments.length?"number"!=typeof d?(console.log("width appears to not be a number - changed to 5"),a):(d%2===0&&d--,3>d&&(d=5),b=d,c=Math.floor(d/2),a):b},a.data=function(b){return h=b,a},a.x=function(b){return arguments.length?(f=b,a):f},a.y=function(b){return arguments.length?(g=b,a):g},a.output=function(){return e},a},ssci.ts.acf=function(){function a(){var a=[];for(a=k.map(function(a){return[i(a),j(a)]}),f=a.length,l>a.length-m&&(l=a.length-m,console.log("Not enough points for the number of lags requested. Max lag changed to "+l)),b=0;l+1>b;b++)g.push(b);if(m>0)for(b=0;f-1>b;b++)h.push(a[b][1]-a[b+1][1]);else for(b=0;f>b;b++)h.push(a[b][1]);if(m>1)for(c=0;m-1>c;c++){for(b=0;f-1-c>b;b++)h[b]=h[b]-h[b+1];h.pop()}for(b=0;l>=b;b++){var n=0,o=0,p=0;for(d=0;f-m>d;d++)n=h[d]+n;for(n/=f-m,d=0;f-m>d;d++)d<f-g[b]-m&&(o+=(h[d]-n)*(h[d+g[b]]-n)),p+=Math.pow(h[d]-n,2);e.push([b,o/p])}}var b,c,d,e=[],f=0,g=[],h=[],i=function(a){return a[0]},j=function(a){return a[1]},k=[],l=20,m=0;return a.output=function(){return e},a.x=function(b){return arguments.length?(i=b,a):i},a.y=function(b){return arguments.length?(j=b,a):j},a.data=function(b){return k=b,a},a.maxlag=function(b){if(!arguments.length)return l;if("number"!=typeof l)throw new Error("maxlag is not a number");return l=b,a},a.diff=function(b){if(!arguments.length)return m;if("number"!=typeof m)throw new Error("diffed is not a number");return m=b,a},a},ssci.ts.diff=function(a){for(var b=[],c=0;c<a.length-1;c++)b.push([a[c][0],a[c+1][1]-a[c][1]]);return b},ssci.ts.pacf=function(){function a(){var a=[];for(a=m.map(function(a){return[k(a),l(a)]}),f=a.length,n>a.length-o&&(n=a.length-o,console.log("Not enough points for the number of lags requested. Max lag changed to "+n)),b=0;n+1>b;b++)g.push(b);if(o>0)for(b=0;f-1>b;b++)h.push(a[b][1]-a[b+1][1]);else for(b=0;f>b;b++)h.push(a[b][1]);if(o>1)for(c=0;o-1>c;c++){for(b=0;f-1-c>b;b++)h[b]=h[b]-h[b+1];h.pop()}for(b=0;n>=b;b++){var p=0,q=0,r=0;for(d=0;f-o>d;d++)p=h[d]+p;for(p/=f-o,d=0;f-o>d;d++)d<f-g[b]-o&&(q+=(h[d]-p)*(h[d+g[b]]-p)),r+=Math.pow(h[d]-p,2);i.push(q/r)}for(d=0;n>=d;d++){var s=[];for(c=0;n>=c;c++)s.push(NaN);j.push(s)}for(j[0][0]=1,j[1][1]=i[1],d=2;n>=d;d++){var t=0;for(c=1;d>c;c++)d-1!==c&&d-2>0&&(j[d-1][c]=j[d-2][c]-j[d-1][d-1]*j[d-2][d-1-c]),t+=j[d-1][c]*i[d-c];j[d][d]=(i[d]-t)/(1-t)}for(d=0;n>=d;d++)e.push([g[d],j[g[d]][g[d]]])}var b,c,d,e=[],f=0,g=[],h=[],i=[],j=[],k=function(a){return a[0]},l=function(a){return a[1]},m=[],n=20,o=0;return a.output=function(){return e},a.x=function(b){return arguments.length?(k=b,a):k},a.y=function(b){return arguments.length?(l=b,a):l},a.data=function(b){return m=b,a},a.maxlag=function(b){if(!arguments.length)return n;if("number"!=typeof n)throw new Error("maxlag is not a number");return n=b,a},a.diff=function(b){if(!arguments.length)return o;if("number"!=typeof o)throw new Error("diffed is not a number");return o=b,a},a},ssci.gamma=function(a){var b=7,c=[.9999999999998099,676.5203681218851,-1259.1392167224028,771.3234287776531,-176.6150291621406,12.507343278686905,-.13857109526572012,9984369578019572e-21,1.5056327351493116e-7];if(.5>a)return Math.PI/(Math.sin(Math.PI*a)*this.gamma(1-a));a-=1;for(var d=c[0],e=1;b+2>e;e++)d+=c[e]/(a+e);var f=a+b+.5;return Math.sqrt(2*Math.PI)*Math.pow(f,a+.5)*Math.exp(-f)*d},ssci.interpString=function(a,b){var c="";if("linear"===a)c=b.join("L");else{if("cubic"!==a)throw new Error("Interpolation not defined = "+a);var d=splineInterpolation(b);c+=b[0][0]+","+b[0][1];for(var e=1;e<b.length;e++){var f=splineToBezier(b[e-1],b[e],d[e-1]);c+="C"+f[0][0]+","+f[0][1]+","+f[1][0]+","+f[1][1]+","+b[e][0]+","+b[e][1]}}return c},ssci.objectToPoints=function(a,b,c){return a.map(function(a){var d=[];return d.push(a[b]),d.push(a[c]),d})},ssci.pointsToObject=function(a){return a.map(function(a){var b={};return b.x=a[0],b.y=a[1],b})},ssci.stackMap=function(a,b,c){return a.map(function(a){var d={};return d.x=a[b],d.y=a[c],d})},ssci.stackMaps=function(a,b,c){for(var d=[],e=0;e<c.length;e++)d.push(this.stackMap(a,b,c[e]));return d},ssci.toStringArray=function(a){var b=a.map(function(a){return a[0]+", "+a[1]});return b.join("\n")};
//# sourceMappingURL=ssci-v1.2.0.min.js.map
return ssci;

}( this ));